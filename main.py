import streamlit as st

# Дерево рішень
decision_tree = {
    "Хочеш чаклувати чи трощити все навколо?": [
        ("Чаклувати", "Ти релігійна людина?"),
        ("А можна і те, і інше?", "Чи добре ти ладнаєш з людьми?"),
        ("Трощити!", "Ближній чи дальній бій?")
    ],
    "Ти релігійна людина?": [
        ("Хочеш почути про мого бога?", "Може, пізніше..."),
        ("Не дуже", "Ти любиш навчання?")
    ],
    "Може, пізніше...": [
        ("Ок.", "Жрець")
    ],
    "Ти любиш навчання?": [
        ("Ні. Навчання — для слабаків", "Ти народилися з магією?"),
        ("Так, я обожнюю вчитися!", "Чи маєш музичний талант?")
    ],
    "Ти народилися з магією?": [
        ("Не зовсім", "Чаклун"),
        ("Так, вона у моїй крові", "Чарівник")
    ],
    "Чи маєш музичний талант?": [
        ("Не дуже", "Чи любиш тварин?"),
        ("Так! Я ще й поезію пишу", "Бард")
    ],
    "Чи любиш тварин?": [
        ("Магічні істоти подобаються більше", "Маг"),
        ("Я надаю перевагу тваринам більше, ніж людям", "Друїд")
    ],
    "Чи добре ти ладнаєш з людьми?": [
        ("Так! Люди зазвичай мене люблять", "Ти підступна людина?"),
        ("Не дуже", "А тварин ти любиш?")
    ],
    "А тварин ти любиш?": [
        ("ТАК! Вони такі пухнасті!", "Друїд"),
        ("Е-е... ну таке.", "Ти підступна людина?")
    ],
    "Ти підступна людина?": [
        ("Не дуже", "Чи віддаєш перевагу закляттям, а не бою?"),
        ("Я — сама ніч", "Шпигун")
    ],
    "Чи віддаєш перевагу закляттям, а не бою?": [
        ("Так. Бій — для слабаків", "Бард"),
        ("Ні. Закляття — це бонус", "Хочеш бути багатими?")
    ],
    "Хочеш бути багатими?": [
        ("Мені байдуже", "Чи знаєш ти бойові мистецтва?"),
        ("Це питання?", "Шпигун")
    ],
    "Ближній чи дальній бій?": [
        ("Дальній", "Тож, чи добре ти ладнаєш з людьми?"),
        ("Ближній", "Чи маєш ти причину?")
    ],
    "Тож, чи добре ти ладнаєш з людьми?": [
        ("Ні, я більше люблю тварин", "Рейнджер"),
        ("Так, люди зазвичай мене люблять", "Ти потайна людина?")
    ],
    "Чи маєш ти причину?": [
        ("Так, мої переконання важливі для мене", "Чи знаєш ти бойові мистецтва?"),
        ("А гроші — це причина?", "Ти цивілізований?")
    ],
    "Чи знаєш ти бойові мистецтва?": [
        ("Ні", "Паладин"),
        ("Мої кулаки жадають справедливості!", "Монах")
    ],
    "Ти цивілізований?": [
        ("Я не їм людей, якщо ти про це...", "Воїн"),
        ("Ні, я виросли у дикій природі", "Варвар")
    ]
}

final_classes = ["Жрець", "Чаклун", "Чарівник", "Маг", "Бард", "Друїд",
                 "Шпигун", "Воїн", "Варвар", "Рейнджер", "Паладин", "Монах"]


if "current_question" not in st.session_state:
    st.session_state.current_question = "Хочеш чаклувати чи трощити все навколо?"

st.title("Який клас D&D тобі підійде?")
st.markdown("Відповідай на кілька питань і дізнайся свій клас!")

question = st.session_state.current_question
options = decision_tree.get(question, [])

st.subheader(question)

for text, next_step in options:
    if st.button(text):
        if next_step in final_classes:
            st.success(f"Тобі слід грати за: **{next_step}**!")
            st.session_state.current_question = "Хочеш чаклувати чи трощити все навколо?"
        else:
            st.session_state.current_question = next_step
        st.experimental_rerun()
